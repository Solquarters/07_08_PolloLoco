<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models/character.class.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models/character.class.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Class representing the game character.
 * 
 * @extends MoveableObject
 * 
 * @property {number} height - The height of the character.
 * @property {number} width - The width of the character.
 * @property {number} speed - The speed at which the character moves.
 * @property {number} y - The y-position of the character.
 * @property {number} currentImage - Index of the current image being displayed.
 * @property {object} world - Reference to the world object the character is part of.
 * 
 * @property {Audio} walking_sound - Sound played when the character walks.
 * @property {Audio} inpain_sound - Sound played when the character gets hurt.
 * @property {Audio} snoring_sound - Sound played when the character is idle for a long time.
 * @property {Audio} jump_sound - Sound played when the character jumps.
 * @property {Audio} characterDeath_sound - Sound played when the character dies.
 * 
 * @property {boolean} jumpAlreadyTriggered - Flag to prevent multiple jumps without landing.
 * @property {number} deadAnimationFrame - Keeps track of the frame count during the death animation.
 * @property {number} idleTimer - Timer for determining long idle state.
 * 
 * @property {object} offset - An object that defines the offset values for collisions.
 * 
 * @property {Array&lt;string>} IMAGES_IDLE - Array of image paths for idle animation.
 * @property {Array&lt;string>} IMAGES_IDLE_LONG - Array of image paths for long idle animation.
 * @property {Array&lt;string>} IMAGES_WALKING - Array of image paths for walking animation.
 * @property {Array&lt;string>} IMAGES_JUMPING - Array of image paths for jumping animation.
 * @property {Array&lt;string>} IMAGES_DEAD - Array of image paths for death animation.
 * @property {Array&lt;string>} IMAGES_HURT - Array of image paths for hurt animation.
 */
class Character extends MoveableObject {
  height = 250;
  width = 130;
  speed = 9;
  y = 20;
  currentImage = 0;
  world;

  walking_sound = new Audio("./sounds/Pollo Loco Sound/steps.ogg");
  inpain_sound = new Audio("./sounds/Pollo Loco Sound/PepeGrunt.ogg");
  snoring_sound = new Audio("./sounds/Pollo Loco Sound/pepe_snoring.ogg");
  jump_sound = new Audio("./sounds/Pollo Loco Sound/jumpbounce.ogg");
  characterDeath_sound = new Audio("./sounds/Pollo Loco Sound/wilhelmscream.ogg");

  jumpAlreadyTriggered = false;
  deadAnimationFrame = 0;
  idleTimer = 0;

  offset = {
    top: 100,
    bottom: 10,
    left: 28,
    right: 20,
  };

  IMAGES_IDLE = [
    "./img/2_character_pepe/1_idle/idle/I-1.png",
    "./img/2_character_pepe/1_idle/idle/I-1.png",
    "./img/2_character_pepe/1_idle/idle/I-1.png",
    "./img/2_character_pepe/1_idle/idle/I-2.png",
    "./img/2_character_pepe/1_idle/idle/I-2.png",
    "./img/2_character_pepe/1_idle/idle/I-2.png",
    "./img/2_character_pepe/1_idle/idle/I-3.png",
    "./img/2_character_pepe/1_idle/idle/I-3.png",
    "./img/2_character_pepe/1_idle/idle/I-3.png",
    "./img/2_character_pepe/1_idle/idle/I-4.png",
    "./img/2_character_pepe/1_idle/idle/I-4.png",
    "./img/2_character_pepe/1_idle/idle/I-4.png",
    "./img/2_character_pepe/1_idle/idle/I-5.png",
    "./img/2_character_pepe/1_idle/idle/I-5.png",
    "./img/2_character_pepe/1_idle/idle/I-5.png",
    "./img/2_character_pepe/1_idle/idle/I-6.png",
    "./img/2_character_pepe/1_idle/idle/I-6.png",
    "./img/2_character_pepe/1_idle/idle/I-6.png",
    "./img/2_character_pepe/1_idle/idle/I-7.png",
    "./img/2_character_pepe/1_idle/idle/I-7.png",
    "./img/2_character_pepe/1_idle/idle/I-7.png",
    "./img/2_character_pepe/1_idle/idle/I-8.png",
    "./img/2_character_pepe/1_idle/idle/I-8.png",
    "./img/2_character_pepe/1_idle/idle/I-8.png",
    "./img/2_character_pepe/1_idle/idle/I-9.png",
    "./img/2_character_pepe/1_idle/idle/I-9.png",
    "./img/2_character_pepe/1_idle/idle/I-9.png",
    "./img/2_character_pepe/1_idle/idle/I-10.png",
    "./img/2_character_pepe/1_idle/idle/I-10.png",
    "./img/2_character_pepe/1_idle/idle/I-10.png",
  ];

  IMAGES_IDLE_LONG = [
    "img/2_character_pepe/1_idle/long_idle/I-11.png",
    "img/2_character_pepe/1_idle/long_idle/I-11.png",
    "img/2_character_pepe/1_idle/long_idle/I-12.png",
    "img/2_character_pepe/1_idle/long_idle/I-12.png",
    "img/2_character_pepe/1_idle/long_idle/I-13.png",
    "img/2_character_pepe/1_idle/long_idle/I-13.png",
    "img/2_character_pepe/1_idle/long_idle/I-14.png",
    "img/2_character_pepe/1_idle/long_idle/I-14.png",
    "img/2_character_pepe/1_idle/long_idle/I-15.png",
    "img/2_character_pepe/1_idle/long_idle/I-15.png",
    "img/2_character_pepe/1_idle/long_idle/I-16.png",
    "img/2_character_pepe/1_idle/long_idle/I-16.png",
    "img/2_character_pepe/1_idle/long_idle/I-17.png",
    "img/2_character_pepe/1_idle/long_idle/I-17.png",
    "img/2_character_pepe/1_idle/long_idle/I-18.png",
    "img/2_character_pepe/1_idle/long_idle/I-18.png",
    "img/2_character_pepe/1_idle/long_idle/I-19.png",
    "img/2_character_pepe/1_idle/long_idle/I-19.png",
    "img/2_character_pepe/1_idle/long_idle/I-20.png",
    "img/2_character_pepe/1_idle/long_idle/I-20.png",
  ];

  IMAGES_WALKING = [
    "./img/2_character_pepe/2_walk/W-21.png",
    "./img/2_character_pepe/2_walk/W-22.png",
    "./img/2_character_pepe/2_walk/W-23.png",
    "./img/2_character_pepe/2_walk/W-24.png",
    "./img/2_character_pepe/2_walk/W-25.png",
    "./img/2_character_pepe/2_walk/W-26.png",
  ];

  IMAGES_JUMPING = [
    "img/2_character_pepe/3_jump/J-31.png",
    "img/2_character_pepe/3_jump/J-31.png",
    "img/2_character_pepe/3_jump/J-32.png",
    "img/2_character_pepe/3_jump/J-32.png",
    "img/2_character_pepe/3_jump/J-33.png",
    "img/2_character_pepe/3_jump/J-33.png",
    "img/2_character_pepe/3_jump/J-34.png",
    "img/2_character_pepe/3_jump/J-34.png",
    "img/2_character_pepe/3_jump/J-35.png",
    "img/2_character_pepe/3_jump/J-35.png",
    "img/2_character_pepe/3_jump/J-35.png",
    "img/2_character_pepe/3_jump/J-36.png",
    "img/2_character_pepe/3_jump/J-36.png",
    "img/2_character_pepe/3_jump/J-36.png",
    "img/2_character_pepe/3_jump/J-37.png",
    "img/2_character_pepe/3_jump/J-37.png",
    "img/2_character_pepe/3_jump/J-37.png",
    "img/2_character_pepe/3_jump/J-38.png",
    "img/2_character_pepe/3_jump/J-38.png",
    "img/2_character_pepe/3_jump/J-38.png",
    "img/2_character_pepe/3_jump/J-39.png",
    "img/2_character_pepe/3_jump/J-39.png",
    "img/2_character_pepe/3_jump/J-39.png",
  ];

  IMAGES_DEAD = [
    "img/2_character_pepe/5_dead/D-51.png",
    "img/2_character_pepe/5_dead/D-51.png",
    "img/2_character_pepe/5_dead/D-52.png",
    "img/2_character_pepe/5_dead/D-52.png",
    "img/2_character_pepe/5_dead/D-53.png",
    "img/2_character_pepe/5_dead/D-53.png",
    "img/2_character_pepe/5_dead/D-54.png",
    "img/2_character_pepe/5_dead/D-54.png",
    "img/2_character_pepe/5_dead/D-55.png",
    "img/2_character_pepe/5_dead/D-55.png",
    "img/2_character_pepe/5_dead/D-56.png",
    "img/2_character_pepe/5_dead/D-56.png",
  ];

  IMAGES_HURT = [
    "img/2_character_pepe/4_hurt/H-41.png",
    "img/2_character_pepe/4_hurt/H-42.png",
    "img/2_character_pepe/4_hurt/H-43.png",
  ];

  constructor() {
    super().loadImage("./img/2_character_pepe/1_idle/idle/I-1.png");
    this.loadImages(this.IMAGES_IDLE);
    this.loadImages(this.IMAGES_IDLE_LONG);
    this.loadImages(this.IMAGES_WALKING);
    this.loadImages(this.IMAGES_JUMPING);
    this.loadImages(this.IMAGES_DEAD);
    this.loadImages(this.IMAGES_HURT);
    this.applyGravity();
    this.animate();
    this.x = 300;

    this.addAudioToGlobalArray();
  }


  /**
 * Adds character-specific audio objects to the global audio array for global mute control.
 */
  addAudioToGlobalArray() {
    globalAudioArray.push(
      this.walking_sound,
      this.inpain_sound,
      this.snoring_sound,
      this.jump_sound,
      this.characterDeath_sound
    );
  }


  /**
 * Probably too long animation function that handles character movement, camera positioning, and animation frames.
 * Runs at a fixed interval to simulate continuous movement.
 */
  animate() {
    //Handle movement
    setStoppableInterval(() => {
      this.walking_sound.pause();
      this.moveRightIfConditionTrue();
      this.moveLeftIfConditionTrue();
      this.jumpIfConditionTrue();
      this.world.camera_x = -this.x + 120;
    }, 1000 / 60);

    //Handle animations
    setStoppableInterval(() => {
      if (this.isDead() &amp;&amp; this.deadAnimationFrame &lt; 12) {
        this.handleDeathCondition();
        return;
      } 
      if (this.isHurt()) {
        this.handleIsHurt();
      } else if (this.isAboveGround()) {
        this.snoring_sound.pause();
        this.playAnimation(this.IMAGES_JUMPING);
      } else {
        if (this.world.keyboard.RIGHT || this.world.keyboard.LEFT) {
          this.snoring_sound.pause();
          this.playAnimation(this.IMAGES_WALKING);
        }
      }
      this.handleShortAndLongIdleAnimation();
    }, 1000 / 20);

  }



  /**
 * Moves the character to the right if the right key is pressed and the condition is met.
 * Plays walking sound if the character is not in the air.
 */
  moveRightIfConditionTrue(){
    if (this.world.keyboard.RIGHT &amp;&amp; this.x &lt; this.world.level.level_end_x) {
      lastInputTimer = new Date().getTime();
      this.moveRight();
      this.otherDirection = false;
      if (!this.isAboveGround()) {
        this.walking_sound.play();
      }
    }
  }

  /**
 * Moves the character to the left if the left key is pressed and the condition is met.
 * Plays walking sound if the character is not in the air.
 */
  moveLeftIfConditionTrue(){
    if (this.world.keyboard.LEFT &amp;&amp; this.x > 120) {
      lastInputTimer = new Date().getTime();
      this.moveLeft();
      this.otherDirection = true;
      if (!this.isAboveGround()) {
        this.walking_sound.play();
      }
    }

  }

  /**
 * Makes the character jump if the up or space key is pressed, and the character is on the ground.
 * Plays the jump sound and sets the jump state.
 */
jumpIfConditionTrue(){
  if ((this.world.keyboard.UP || this.world.keyboard.SPACE) &amp;&amp;!this.isAboveGround() &amp;&amp; !this.jumpAlreadyTriggered) 
    {
    lastInputTimer = new Date().getTime();
    this.jump_sound.play();
    this.jumpAlreadyTriggered = true;
    this.currentImage = 9;
    this.jump();
  }
}

/**
 * Handles the character's death animation and triggers the game over screen after completion.
 * Plays the death sound during the animation.
 */
handleDeathCondition(){
    this.characterDeath_sound.play();
    if (this.deadAnimationFrame == 0) {
      this.currentImage = 0;
    }
    this.playAnimation(this.IMAGES_DEAD);
    this.deadAnimationFrame++;
    if (this.deadAnimationFrame == 12) {
      //If dead animation reaches end, display end screen
      stopGame();
      document.getElementById("gameLostOverlayDivId").style.display =
        "flex";
    }
}

/**
 * Handles the animation and sound when the character is hurt.
 * Plays the hurt sound and pauses other sounds.
 */
handleIsHurt(){
  this.snoring_sound.pause();
  this.playAnimation(this.IMAGES_HURT);
  this.inpain_sound.play();
}

/**
 * Controls the character's idle animations based on the time since the last input.
 * Plays the snoring sound if the character has been idle for a certain period.
 */
handleShortAndLongIdleAnimation(){
  let timePassed = new Date().getTime() - lastInputTimer;
  if (timePassed / 1000 > 4) {
    this.playAnimation(this.IMAGES_IDLE_LONG);
    this.snoring_sound.play();
  } else if (
    !this.isAboveGround() &amp;&amp;
    !this.isDead() &amp;&amp;
    !this.isHurt() &amp;&amp;
    !(this.world.keyboard.RIGHT || this.world.keyboard.LEFT)
  ) {
    this.snoring_sound.pause();
    this.playAnimation(this.IMAGES_IDLE);
  }
}

}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Character.html">Character</a></li><li><a href="Endboss.html">Endboss</a></li><li><a href="Level.html">Level</a></li><li><a href="MoveableObject.html">MoveableObject</a></li><li><a href="ThrowableObject.html">ThrowableObject</a></li><li><a href="World.html">World</a></li></ul><h3>Global</h3><ul><li><a href="global.html#checkOrientation">checkOrientation</a></li><li><a href="global.html#enterFullscreen">enterFullscreen</a></li><li><a href="global.html#exitFullscreen">exitFullscreen</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initLevel">initLevel</a></li><li><a href="global.html#returnChickensForLevel">returnChickensForLevel</a></li><li><a href="global.html#returnCoinsAndBottlesForLevel">returnCoinsAndBottlesForLevel</a></li><li><a href="global.html#returnLevelBackgroundArray">returnLevelBackgroundArray</a></li><li><a href="global.html#setStoppableInterval">setStoppableInterval</a></li><li><a href="global.html#stopGame">stopGame</a></li><li><a href="global.html#toggleAllAudio">toggleAllAudio</a></li><li><a href="global.html#toggleFullscreen">toggleFullscreen</a></li><li><a href="global.html#toggleInfoOverlay">toggleInfoOverlay</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Thu Sep 19 2024 20:43:06 GMT+0200 (Mitteleurop√§ische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
